<!DOCTYPE html>
<html lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
      <title>PoshFG -  Persistance </title>
      <!-- load style sheets -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
    <link rel="stylesheet" href="./style.css">
    <!-- Load scripts -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
      
      
    </head>
    <body id="top">
      <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <a class="navbar-brand" href="./index.html">PowerShell Field Guide</a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
      
        <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
          <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
            <li class="nav-item active">
              <a class="nav-link" href="./Learn.html">Learn</a>
            </li>
            <li class="nav-item ">
              <a class="nav-link" href="./Links.html">Links</a>
            </li>
          </ul>
        </div>
      </nav>

      <nav aria-label="breadcrumb">
        <ol class="breadcrumb bg-white">
            
<li class="breadcrumb-item" aria-current="page"><a href="./Learn.html">Home</a></li>
<li class="breadcrumb-item active" aria-current="page"> Persistance </li>

        </ol>
      </nav>

    <div class="content-div">
     
<div class="content-card card mx-5 mb-5">
    <div class="card-header text-center bg-dark text-light">
        <h1 class="display-4">Solving Problems</h1>
    </div>
    <div class="card-body justify-content-center">
        <div>
            <h1 class="text-center my-4">Storing data in xml files</h1>
            <p>
                This is the third lesson in a series of lessons on how 
you can save data so you can use it later with PowerShell.             
            </p>
            <h2 class="text-center my-4">Before you begin: </h2>
            <p>
                In this lesson, we will be using PowerShell files you can find in the following github repo in a folder named 
                PowerShell_Peristance:
                <a href="https://github.com/PowerShellFieldGuide/Examples">https://github.com/PowerShellFieldGuide/Examples</a>.
                If you have never used Github before, for full instructions on how to download this file, please see my page on 
                <a href="./Getting_Started.html">Getting Started</a>.
            </p>
            <h2 class="text-center my-4">Xml files</h2>
            <p>
                I'm going to make one assumption here which may or may 
not be true. I'm going to assume that you understand what an xml
                file is and how xml data is structured. The reason I 
want to make this assumption is this lesson is already going to be
                longer than I want to write (I have a rule that if it's 
painful to write it's also painful to read). W3Schools is a good
                place to brush up on this if you're new to working with 
xml files: 
                <a href="https://www.w3schools.com/xml/default.asp">https://www.w3schools.com/xml/default.asp</a>
            </p>
            <h2 class="text-center my-4">Export-Clixml</h2>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Export-Clixml.png"><br>
            </div>
            <p>
                The next few examples are pretty much identical to the 
examples in the lesson on csv files. Export-Clixml exports the
                data in clixml format. Clixml stands for Common Language
 Infrastructure XML and it is a way to represent .Net Framework
                objects. This is stored in an xml file and can be 
imported later. Here we pipe the timezone from our machine with the
                Get-Timezone cmdlet into Export-Clixml and export the 
data to a file named Demo.xml.
            </p>
            <h2 class="text-center my-4">Import-Clixml</h2>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Import-Clixml.png"><br>
            </div>
            <p>
                Import-Clixml is a cmdlet that imports the clixml data back into the shell.
            </p>
            <h2 class="text-center my-4">Working with Clixml data in the shell</h2>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Import-Clixml_With_Variables.png"><br>
            </div>
            <p>
                Here I've recreated the working with data in the shell 
example from the last lesson, except this time using xml files instead 
of csv
                files. It's nice because you can pick whichever is most 
appropriate for your situation and things work mostly the same.
            </p>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Import-Clixml_Get-Member.png"><br>
            </div>
            <p>
                Once again, when comparing the data before and after 
being exported with Get-Member, some of the methods are no longer 
available
                when we import the data back into PowerShell.
            </p>
            <h5 class="text-center my-4">Write-DateToXml</h5>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Write-DateToClixml.png"><br>
            </div>
            <p>
                Here we have our Write-Date script once again, but this time we are storing our date in clixml format.
            </p>
            <h5 class="text-center my-4">Console</h5>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Write-DateToClixml-Result.png"><br>
            </div>
            <p>
                As a quick demo, I run the script on my machine and then
 change directories to display the output (Get-Date.xml). I then open
                the file with notepad to see what's inside.
            </p>
            <h5 class="text-center my-4">Xml file</h5>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Write-DateToClixml-Notepad.png"><br>
            </div>
            <p>
                If you stare at this for a minute you might be able to 
understand some of it and while it's not completely incomprehensible,
                it's definitely harder to understand than the csv file 
in the last lesson.
            </p>
            <h5 class="text-center my-4">This is hard to read, why shouldn't I just use csv files?</h5>
            <p>
                Xml files do a better job preserving the original data 
than Csv in PowerShell. This should always be your goal since it is 
better to
                keep the data in its original format until your ready to
 use it. Let me try to show you why. Let's import the date from our csv 
file
                and store it in a variable named $Csv. I'm not sure what
 properties the original object had before I stored it, so I want to 
display
                them in the console. I think the month property will be 
good for our purposes here.
            </p>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/CsvProperty.png"><br>
            </div>
            <p>
                I display that property in the console and you can see 
it is 11. But what type is it? Originally it was an Int32, but when we 
stored
                it in our csv file, we converted it to a string.
            </p>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/XmlProperty.png"><br>
            </div>
            <p>
                If we do the same thing with the data stored in our xml 
file, we can see that clixml format preserved the type (Int32) of the 
original
                Month property. If you're storing something that you are
 going to be consuming later with another script, it is better to export
 to an
                xml file. If it is something you are saving like a 
report that someone else might want to read later, it is probably better
 to use csv
                files.
            </p>
            <h5 class="text-center my-4">Export-AdminsToXml</h5>
            <div class="d-flex justify-content-center container-fluid my-3">
                <img class="border img-fluid" src="./Persistance3_files/Export-AdminsToClixml.png"><br>
            </div>
            <p>
                This is the final iteration of our Export-AdminsToFile 
script. If I were using this script, this is the version I would use in 
production.
                If I wanted to create reports for a supervisor, I would 
have another script that would collect this data and collate it into one
 csv file.
            </p>
        </div>
    </div>
</div>

    
<div class="text-center">
     <a href="./Csv.html">Previous</a>
    <a href="./MsiExec.html">Next</a>
</div>

    </div>
    
</body></html>














































